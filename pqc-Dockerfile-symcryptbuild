FROM ubuntu:22.04

RUN apt-get update && apt-get install -y \
    build-essential cmake python3 python3-pip git clang \
    && rm -rf /var/lib/apt/lists/*

WORKDIR /symcrypt
RUN git clone https://github.com/microsoft/SymCrypt.git . \
    && git submodule update --init \
    && pip3 install -r scripts/requirements.txt

RUN python3 scripts/build.py cmake build --config Release
